<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.withearth.member.dao.MemberDAO">

<!-- 로그인할때 사용2) Member타입의 resultMap 왜써야 하는건지 모르겠어요-->
<resultMap id="memberResult"
			type="com.withearth.member.domain.Member">
	<id column="idx" property="idx"/>
	<result column="id" property="id"/>
	<result column="pw" property="pw"/>
	<result column="name" property="name"/>
	<result column="photo" property="photo"/>
</resultMap>


<!-- 회원가입 -->

<insert id="insertMember"
	parameterType="com.withearth.member.domain.Member"
	useGeneratedKeys="true"
	keyProperty="idx"
	>
<if test="photo != null and logintype=='email'">
INSERT INTO USER (id,pw,name,photo,logintype) 
VALUES( #{id}, #{pw}, #{name}, #{photo}, #{logintype} )
</if>
<if test="photo == null and logintype=='email'">
INSERT INTO USER (id,pw,name,logintype) 
VALUES( #{id}, #{pw}, #{name}, #{logintype} )
</if>
<if test="logintype=='kakao'">
INSERT INTO USER (id,name,photo,logintype,verify) 
VALUES( #{id}, #{name}, #{photo}, #{logintype}, #{verify} )
</if>
</insert>

<!-- 로그인 -->
<select id="selectLogin"
		resultMap="memberResult"> <!-- id와 매핑된다. -->

select * from user where id= #{param1} and pw=#{param2}
</select>

</mapper>