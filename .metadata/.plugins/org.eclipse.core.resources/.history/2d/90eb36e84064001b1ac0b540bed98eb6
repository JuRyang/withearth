package com.withearth.tumbler.controller;

//qr코드 등록 및 생성
@RequestMapping(value = "/qr_create.do", method={RequestMethod.GET, RequestMethod.POST})
@ResponseBody
public void qr_create(WriteVO WriteVO) throws Exception{
 Logger.info(null);
 String name = WriteVO.getName()+".png";
 String url = WriteVO.getUrl();

 try {
     File file = null;
     // qr코드 이미지를 저장할 디렉토리 지정
     file = new File("D:\\dWorkSpace\\qr_code\\qr_image");
     if(!file.exists()) {
         file.mkdirs();
     }
     // qr코드 인식시 이동할 url 주소
     String codeurl = new String(url.getBytes("UTF-8"), "ISO-8859-1");
     // qr코드 바코드 생성값
     int qrcodeColor = 0xFF2e4e96;
     // qr코드 배경색상값
     int backgroundColor = 0xFFFFFFFF;
       
     QRCodeWriter qrCodeWriter = new QRCodeWriter();
     // 3,4번째 parameter값 : width/height값 지정
     BitMatrix bitMatrix = qrCodeWriter.encode(codeurl, BarcodeFormat.QR_CODE,200, 200);
     //
     MatrixToImageConfig matrixToImageConfig = new MatrixToImageConfig(qrcodeColor,backgroundColor);
     BufferedImage bufferedImage = MatrixToImageWriter.toBufferedImage(bitMatrix,matrixToImageConfig);
     // ImageIO를 사용한 바코드 파일쓰기
     ImageIO.write(bufferedImage, "png", new File("D:\\dWorkSpace\\qr_code\\qr_image\\"+name));
       
 } catch (Exception e) {
     e.printStackTrace();
 }
 Logger.info("바코드 생성 끝");
}

